Realised coding style has improved in this question. Would have taken a lot more lines to write this question 5 months back.